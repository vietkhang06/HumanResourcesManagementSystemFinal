<Window x:Class="HumanResourcesManagementSystemFinal.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:HumanResourcesManagementSystemFinal.ViewModels"
        
        xmlns:cnv="clr-namespace:HumanResourcesManagementSystemFinal.Converters"
        xmlns:converters="clr-namespace:HumanResourcesManagementSystemFinal.Converters" 
        
        mc:Ignorable="d"
        Title="Hệ Thống Quản Lý Nhân Sự" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        MouseDown="Window_MouseDown">

    <d:Window.DataContext>
        <vm:MainViewModel/>
    </d:Window.DataContext>

    <Window.Resources>
        <converters:EmployeeIdToImageConverter x:Key="IdToImageConverter"/>

        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <cnv:UpperCaseConverter x:Key="ToUpperCaseConverter"/>

        <Storyboard x:Key="CloseMenuAnimation">
            <DoubleAnimation Storyboard.TargetName="SidebarBorder"
                             Storyboard.TargetProperty="Width"
                             To="70" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="OpenMenuAnimation">
            <DoubleAnimation Storyboard.TargetName="SidebarBorder"
                             Storyboard.TargetProperty="Width"
                             To="260" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Style TargetType="Button" x:Key="MenuButtonStyle">
            <Setter Property="Foreground" Value="#1E3A8A"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Height" Value="55"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <Grid Width="260" HorizontalAlignment="Left">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <ContentPresenter Content="{TemplateBinding Content}" Grid.ColumnSpan="2"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F1F5F9"/>
                    <Setter Property="Foreground" Value="#1E3A8A"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Path" x:Key="MenuIconStyle">
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Stretch" Value="Uniform"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Fill" Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
            <Setter Property="Grid.Column" Value="0"/>
        </Style>

        <Style TargetType="TextBlock" x:Key="MenuTextStyle">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Grid.Column" Value="1"/>
            <Setter Property="Margin" Value="0,0,0,0"/>
        </Style>

        <Style TargetType="Button" x:Key="WindowBtnStyle">
            <Setter Property="Width" Value="45"/>
            <Setter Property="Height" Value="35"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="0,0,8,8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E2E8F0"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border Background="#F9F8F6">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" Direction="-90" RenderingBias="Quality" ShadowDepth="2" Opacity="0.1"/>
        </Border.Effect>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border x:Name="SidebarBorder" Grid.Column="0" Width="70" 
                    Background="White" Panel.ZIndex="100"
                    ClipToBounds="True"
                    MouseEnter="Sidebar_MouseEnter"
                    MouseLeave="Sidebar_MouseLeave">

                <Border.Effect>
                    <DropShadowEffect Color="#64748B" Direction="0" ShadowDepth="4" BlurRadius="20" Opacity="0.15"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="0,10,0,40">
                        <Grid Width="260" HorizontalAlignment="Left">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Image Grid.Column="0" 
                                   Source="/Images/logo PRO.jpg" 
                                   Width="60" Height="60" 
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>

                            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="-10,0,0,0">
                                <TextBlock Text=" HRMS PRO" Foreground="#1E3A8A" FontSize="28" FontWeight="Bold"/>
                                <TextBlock Text="   Management System" Foreground="#BDC3C7" FontSize="12"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>

                    <StackPanel Grid.Row="1">
                        <Button Command="{Binding NavigateHomeCommand}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M21 20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V9.48907C3 9.18048 3.14247 8.88917 3.38606 8.69972L11.3861 2.47749C11.7472 2.19663 12.2528 2.19663 12.6139 2.47749L20.6139 8.69972C20.8575 8.88917 21 9.18048 21 9.48907V20ZM19 19V9.97815L12 4.53371L5 9.97815V19H19Z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Trang Chủ" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigateEmployeeCommand}" Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M2 22C2 17.5817 5.58172 14 10 14C14.4183 14 18 17.5817 18 22H16C16 18.6863 13.3137 16 10 16C6.68629 16 4 18.6863 4 22H2ZM10 13C6.685 13 4 10.315 4 7C4 3.685 6.685 1 10 1C13.315 1 16 3.685 16 7C16 10.315 13.315 13 10 13ZM10 11C12.21 11 14 9.21 14 7C14 4.79 12.21 3 10 3C7.79 3 6 4.79 6 7C6 9.21 7.79 11 10 11ZM18.2837 14.7028C21.0644 15.9561 23 18.752 23 22H21C21 19.564 19.5483 17.4671 17.4628 16.5271L18.2837 14.7028ZM17.5962 3.41321C19.5944 4.23703 21 6.20361 21 8.5C21 11.3702 18.8042 13.7252 16 13.9776V11.9646C17.6967 11.7222 19 10.264 19 8.5C19 7.11935 18.2016 5.92603 17.041 5.35635L17.5962 3.41321Z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Quản Lý Nhân Viên" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigateDepartmentCommand}" Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M16 4V9H10V11H16V17H10V20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4H16ZM14 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20H8V15H14V13H8V7H14V4ZM2 6C2 3.79086 3.79086 2 6 2H18C20.2091 2 22 3.79086 22 6V18C22 20.2091 20.2091 22 18 22H6C3.79086 22 2 20.2091 2 18V6Z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Phòng Ban &amp; Chức Vụ" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigatePayrollCommand}" Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M5.00488 9.00281C5.55717 9.00281 6.00488 9.45052 6.00488 10.0028C7.63965 10.0028 9.14352 10.5632 10.3349 11.5023L12.5049 11.5028C13.8375 11.5028 15.0348 12.0821 15.8588 13.0025L19.0049 13.0028C20.9972 13.0028 22.7173 14.1681 23.521 15.8542C21.1562 18.9748 17.3268 21.0028 13.0049 21.0028C10.2142 21.0028 7.85466 20.3996 5.944 19.3449C5.80557 19.7284 5.43727 20.0028 5.00488 20.0028H2.00488C1.4526 20.0028 1.00488 19.5551 1.00488 19.0028V10.0028C1.00488 9.45052 1.4526 9.00281 2.00488 9.00281H5.00488ZM6.00589 12.0028L6.00488 17.0248L6.05024 17.0573C7.84406 18.3177 10.183 19.0028 13.0049 19.0028C16.0089 19.0028 18.8035 17.8472 20.84 15.8734L20.9729 15.7398L20.8537 15.6394C20.3897 15.2764 19.8205 15.0512 19.2099 15.0097L19.0049 15.0028L16.8934 15.0028C16.9664 15.3244 17.0049 15.6591 17.0049 16.0028V17.0028H8.00488V15.0028L14.7949 15.0018L14.7605 14.9233C14.38 14.1297 13.593 13.5681 12.6693 13.5081L12.5049 13.5028L9.57547 13.5027C8.66823 12.5773 7.40412 12.0031 6.00589 12.0028ZM4.00488 11.0028H3.00488V18.0028H4.00488V11.0028ZM18.0049 5.00281C19.6617 5.00281 21.0049 6.34595 21.0049 8.00281C21.0049 9.65966 19.6617 11.0028 18.0049 11.0028C16.348 11.0028 15.0049 9.65966 15.0049 8.00281C15.0049 6.34595 16.348 5.00281 18.0049 5.00281ZM18.0049 7.00281C17.4526 7.00281 17.0049 7.45052 17.0049 8.00281C17.0049 8.55509 17.4526 9.00281 18.0049 9.00281C18.5572 9.00281 19.0049 8.55509 19.0049 8.00281C19.0049 7.45052 18.5572 7.00281 18.0049 7.00281ZM11.0049 2.00281C12.6617 2.00281 14.0049 3.34595 14.0049 5.00281C14.0049 6.65966 12.6617 8.00281 11.0049 8.00281C9.34803 8.00281 8.00488 6.65966 8.00488 5.00281C8.00488 3.34595 9.34803 2.00281 11.0049 2.00281ZM11.0049 4.00281C10.4526 4.00281 10.0049 4.45052 10.0049 5.00281C10.0049 5.55509 10.4526 6.00281 11.0049 6.00281C11.5572 6.00281 12.0049 5.55509 12.0049 5.00281C12.0049 4.45052 11.5572 4.00281 11.0049 4.00281Z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Bảng Lương" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigateProfileCommand}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M144 128a80 80 0 1 1 160 0 80 80 0 1 1 -160 0zm208 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0zM48 480c0-70.7 57.3-128 128-128l96 0c70.7 0 128 57.3 128 128l0 8c0 13.3 10.7 24 24 24s24-10.7 24-24l0-8c0-97.2-78.8-176-176-176l-96 0C78.8 304 0 382.8 0 480l0 8c0 13.3 10.7 24 24 24s24-10.7 24-24l0-8z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Hồ Sơ Của Tôi" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigateLeaveRequestCommand}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M64 112c-8.8 0-16 7.2-16 16v22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16H448c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64H448c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Nghỉ Phép" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigateTimeSheetCommand}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M328 0c13.3 0 24 10.7 24 24l0 40 32 0c35.3 0 64 28.7 64 64l0 288c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 128C0 92.7 28.7 64 64 64l32 0 0-40c0-13.3 10.7-24 24-24s24 10.7 24 24l0 40 160 0 0-40c0-13.3 10.7-24 24-24zM64 112c-8.8 0-16 7.2-16 16l0 288c0 8.8 7.2 16 16 16l320 0c8.8 0 16-7.2 16-16l0-288c0-8.8-7.2-16-16-16L64 112zm230.7 65.9c7.8-10.7 22.8-13.1 33.5-5.3 10.7 7.8 13.1 22.8 5.3 33.5L211.4 374.1c-4.1 5.7-10.5 9.3-17.5 9.8-7 .5-13.9-2-18.8-6.9l-55.9-55.9c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l36 36 105.6-145.2z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Chấm Công" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>

                        <Button Command="{Binding NavigateHistoryCommand}" Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}" Style="{StaticResource MenuButtonStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Path Data="M13 3C7.48 3 3 7.48 3 13s4.48 10 10 10 10-4.48 10-10S18.52 3 13 3zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H12v6l5.25 3.15.75-1.23-4.5-2.67z" Style="{StaticResource MenuIconStyle}"/>
                                <TextBlock Text="Lịch Sử Hệ Thống" Style="{StaticResource MenuTextStyle}"/>
                            </Grid>
                        </Button>
                    </StackPanel>

                    <Button x:Name="BtnUserProfile" Grid.Row="2" Height="70" 
                            Background="Transparent" BorderThickness="0" Cursor="Hand"
                            Click="UserProfile_Click">

                        <Button.Resources>
                            <Style TargetType="ContextMenu">
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="HasDropShadow" Value="True"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ContextMenu">
                                            <Border Background="White" CornerRadius="8" Padding="5" BorderThickness="1" BorderBrush="#CBD5E1">
                                                <Border.Effect>
                                                    <DropShadowEffect BlurRadius="15" Color="Black" Opacity="0.1" ShadowDepth="4"/>
                                                </Border.Effect>
                                                <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                            <Style TargetType="MenuItem">
                                <Setter Property="FontSize" Value="14"/>
                                <Setter Property="FontWeight" Value="Medium"/>
                                <Setter Property="Foreground" Value="#1A3D64"/>
                                <Setter Property="Height" Value="40"/>
                                <Setter Property="Cursor" Value="Hand"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="MenuItem">
                                            <Border x:Name="Border" Background="Transparent" CornerRadius="6" Padding="10,0">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="30"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <ContentPresenter Content="{TemplateBinding Icon}" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                    <ContentPresenter Content="{TemplateBinding Header}" Grid.Column="1" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                                </Grid>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsHighlighted" Value="True">
                                                    <Setter TargetName="Border" Property="Background" Value="#F1F5F9"/>
                                                    <Setter Property="Foreground" Value="#254E7A"/>
                                                </Trigger>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter Property="Opacity" Value="0.5"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Button.Resources>

                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border" Background="{TemplateBinding Background}" BorderThickness="0,1,0,0" BorderBrush="#F1F5F9">
                                    <Grid Width="260" HorizontalAlignment="Left">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>

                                        <Grid Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <Ellipse Width="40" Height="40" Stroke="#1A3D64" StrokeThickness="2">
                                                <Ellipse.Fill>
                                                    <ImageBrush ImageSource="{Binding CurrentUserAvatar, Converter={StaticResource IdToImageConverter}}" 
                                                                Stretch="UniformToFill"/>
                                                </Ellipse.Fill>
                                            </Ellipse>
                                        </Grid>

                                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="5,0,0,0">
                                            <TextBlock Text="{Binding CurrentUserName}" FontWeight="Bold" Foreground="#1A3D64" FontSize="14" TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Text="{Binding CurrentUserJob}" Foreground="#64748B" FontSize="12" TextTrimming="CharacterEllipsis"/>
                                        </StackPanel>

                                        <Path Grid.Column="2" Data="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z" 
                                              Fill="#94A3B8" Stretch="Uniform" Width="10" HorizontalAlignment="Center"/>
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="#F8FAFC"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>

                        <Button.ContextMenu>
                            <ContextMenu x:Name="UserContextMenu" Placement="Top" StaysOpen="False" Closed="UserContextMenu_Closed">
                                <MenuItem Header="Hồ sơ cá nhân" Command="{Binding NavigateProfileCommand}">
                                    <MenuItem.Icon>
                                        <Path Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" 
                                              Fill="#1A3D64" Width="16" Height="16" Stretch="Uniform"/>
                                    </MenuItem.Icon>
                                </MenuItem>

                                <MenuItem Header="Đổi mật khẩu" Command="{Binding NavigateChangePasswordCommand}">
                                    <MenuItem.Icon>
                                        <Path Data="M12.65 10C11.83 7.67 9.61 6 7 6C3.69 6 1 8.69 1 12S3.69 18 7 18C9.61 18 11.83 16.33 12.65 14H17V18H21V14H23V10H12.65M7 14C5.9 14 5 13.1 5 12S5.9 10 7 10 9 10.9 9 12 8.1 14 7 14Z" 
                                              Fill="#1A3D64" Width="16" Height="16" Stretch="Uniform"/>
                                    </MenuItem.Icon>
                                </MenuItem>

                                <Separator/>

                                <MenuItem Header="Đăng Xuất" Command="{Binding LogoutCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}" Foreground="#EF4444" FontWeight="Bold">
                                    <MenuItem.Icon>
                                        <Path Data="M16,17V14H9V10H16V7L21,12L16,17M14,2H7A2,2 0 0,0 5,4V20A2,2 0 0,0 7,22H14A2,2 0 0,0 16,20V18H14V20H7V4H14V6H16V4A2,2 0 0,0 14,2Z" 
                                              Fill="#EF4444" Width="16" Height="16" Stretch="Uniform"/>
                                    </MenuItem.Icon>
                                </MenuItem>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>
                </Grid>
            </Border>

            <Grid Grid.Column="1">
                <Grid VerticalAlignment="Top" Height="60" Panel.ZIndex="1">
                    <Border HorizontalAlignment="Left" VerticalAlignment="Stretch"
                            CornerRadius="0,0,25,0" Margin="0,0,0,10">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#1E3A8A" Offset="0"/>
                                <GradientStop Color="#1E3A8A" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" Direction="-45" Opacity="0.15" ShadowDepth="3"/>
                        </Border.Effect>
                        <TextBlock VerticalAlignment="Center" Margin="30,0,50,0"
                                   FontSize="16" Foreground="White" FontWeight="Bold">
                            <Run Text="{Binding PageTitle, Converter={StaticResource ToUpperCaseConverter}}"/>
                        </TextBlock>
                    </Border>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,5,5,0">
                        <Button Click="btnMinimize_Click" ToolTip="Thu nhỏ" Style="{StaticResource WindowBtnStyle}">
                            <Path Data="M2,18 L22,18 L22,14 L2,14 Z" Fill="#1E3A8A" Stretch="Uniform" Width="12"/>
                        </Button>
                        <Button Click="btnMaximize_Click" ToolTip="Phóng to" Style="{StaticResource WindowBtnStyle}">
                            <Path x:Name="iconMaximize" Data="M4,4 H20 V20 H4 Z M8,8 V16 H16 V8 Z" Fill="#1E3A8A" Stretch="Uniform" Width="12"/>
                        </Button>
                        <Button Click="btnClose_Click" ToolTip="Đóng" Width="40" Style="{StaticResource WindowBtnStyle}">
                            <Path Data="M24.2,5.8 L18.4,0 L12.1,6.3 L5.8,0 L0,5.8 L6.3,12.1 L0,18.4 L5.8,24.2 L12.1,17.9 L18.4,24.2 L24.2,18.4 L17.9,12.1 Z" Fill="#B43F3F" Stretch="Uniform" Width="12"/>
                        </Button>
                    </StackPanel>
                </Grid>

                <ContentControl Content="{Binding CurrentView}" Margin="30,70,30,30" Panel.ZIndex="0"/>
            </Grid>
        </Grid>
    </Border>
</Window>