<UserControl x:Class="HumanResourcesManagementSystemFinal.Views.ChangeHistoryControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:HumanResourcesManagementSystemFinal.ViewModels"
             mc:Ignorable="d" d:DesignHeight="600" d:DesignWidth="940">

    <UserControl.DataContext>
        <vm:ChangeHistoryViewModel/>
    </UserControl.DataContext>

    <UserControl.Resources>
        <Geometry x:Key="IconUser">M11.9999 17C15.6623 17 18.8649 18.5751 20.607 20.9247L18.765 21.796C17.3473 20.1157 14.8473 19 11.9999 19C9.15248 19 6.65252 20.1157 5.23479 21.796L3.39355 20.9238C5.13576 18.5747 8.33796 17 11.9999 17ZM11.9999 2C14.7613 2 16.9999 4.23858 16.9999 7V10C16.9999 12.6888 14.8776 14.8818 12.2168 14.9954L11.9999 15C9.23847 15 6.9999 12.7614 6.9999 10V7C6.9999 4.31125 9.1222 2.11818 11.783 2.00462L11.9999 2ZM11.9999 4C10.4022 4 9.09623 5.24892 9.00499 6.82373L8.9999 7V10C8.9999 11.6569 10.343 13 11.9999 13C13.5976 13 14.9036 11.7511 14.9948 10.1763L14.9999 10V7C14.9999 5.34315 13.6567 4 11.9999 4Z</Geometry>
        <Geometry x:Key="IconHistory">M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C10.298 22 8.69525 21.5748 7.29229 20.8248L2 22L3.17629 16.7097C2.42562 15.3063 2 13.7028 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 13.3347 4.32563 14.6181 4.93987 15.7664L5.28952 16.4201L4.63445 19.3663L7.58189 18.7118L8.23518 19.061C9.38315 19.6747 10.6659 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM13 7V12H17V14H11V7H13Z</Geometry>
        <Geometry x:Key="IconEye">M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512zM224 160a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm-8 64l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24z</Geometry>
    </UserControl.Resources>

    <Grid Background="Transparent" Margin="20,0,20,20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Margin="0,0,0,15">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Border Width="40" Height="40" CornerRadius="12" Background="#E0F2F1" Margin="0,0,15,0">
                    <Path Data="{StaticResource IconHistory}" Fill="#009688" Width="20" Height="20" Stretch="Uniform" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </Border>
                <StackPanel VerticalAlignment="Center">
                    <TextBlock Text="Nhật Ký Hoạt Động" FontSize="20" FontWeight="Bold" Foreground="#1A3D64"/>
                    <TextBlock Text="Theo dõi toàn bộ thay đổi dữ liệu trong hệ thống" FontSize="13" Foreground="#718096" Margin="0,3,0,0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <Border Grid.Row="1" Background="White" CornerRadius="15" BorderBrush="#EDF2F7" BorderThickness="1">
            <Border.Effect>
                <DropShadowEffect BlurRadius="20" Color="#000000" Opacity="0.05" ShadowDepth="5"/>
            </Border.Effect>

            <DataGrid ItemsSource="{Binding Histories}" AutoGenerateColumns="False" 
                      IsReadOnly="True" CanUserAddRows="False"
                      GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                      Background="Transparent" BorderThickness="0"
                      RowHeight="50" HorizontalGridLinesBrush="#F7FAFC">

                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="#A0AEC0"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="FontSize" Value="12"/>
                        <Setter Property="Padding" Value="20,15"/>
                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Setter Property="BorderBrush" Value="#EDF2F7"/>
                    </Style>

                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="White"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F7FAFC"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>

                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="20,0"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="Transparent">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.Resources>

                <DataGrid.Columns>
                    <DataGridTemplateColumn Header="THỜI GIAN" Width="160">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ChangeTime, StringFormat='HH:mm'}" FontWeight="Bold" Foreground="#2D3748" FontSize="14"/>
                                    <TextBlock Text="{Binding ChangeTime, StringFormat='dd/MM/yyyy'}" Foreground="#A0AEC0" FontSize="11"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="NGƯỜI THỰC HIỆN" Width="200">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <Border Width="32" Height="32" CornerRadius="16" Background="#EBF8FF" Margin="0,0,12,0">
                                        <Path Data="{StaticResource IconUser}" Fill="#3182CE" Width="16" Height="16" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="{Binding Account.Username}" FontWeight="SemiBold" Foreground="#2D3748" VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="HÀNH ĐỘNG" Width="140">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border CornerRadius="6" Padding="10,4" HorizontalAlignment="Left" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ActionType}" FontWeight="Bold" FontSize="11"/>
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ActionType}" Value="CREATE">
                                                    <Setter Property="Background" Value="#C6F6D5"/>
                                                    <Setter Property="TextBlock.Foreground" Value="#22543D"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="UPDATE">
                                                    <Setter Property="Background" Value="#BEE3F8"/>
                                                    <Setter Property="TextBlock.Foreground" Value="#2A4365"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="DELETE">
                                                    <Setter Property="Background" Value="#FED7D7"/>
                                                    <Setter Property="TextBlock.Foreground" Value="#822727"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                </Border>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTextColumn Header="BẢNG DỮ LIỆU" Binding="{Binding TableName}" Width="150" FontWeight="SemiBold" Foreground="#718096"/>

                    <DataGridTemplateColumn Header="CHI TIẾT" Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Background="Transparent" BorderThickness="0" Cursor="Hand" 
                                        HorizontalAlignment="Left" ToolTipService.InitialShowDelay="100">

                                    <Path Data="{StaticResource IconEye}" Fill="#A0AEC0" Width="24" Height="24" Stretch="Uniform" Margin="10,0,0,0"/>

                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}">
                                                            <ContentPresenter VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="#3182CE"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>

                                    <Button.ToolTip>
                                        <ToolTip Background="White" BorderBrush="#E2E8F0" BorderThickness="1" Padding="10">
                                            <StackPanel MaxWidth="300">
                                                <TextBlock Text="Chi Tiết Thay Đổi" FontWeight="Bold" Foreground="#1A3D64" Margin="0,0,0,5"/>
                                                <TextBlock Text="{Binding Details}" TextWrapping="Wrap" Foreground="#4A5568"/>
                                            </StackPanel>
                                        </ToolTip>
                                    </Button.ToolTip>
                                </Button>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</UserControl>